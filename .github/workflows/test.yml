name: Sync Forked Repository

on:
  push:
    branches:
      - main

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout forked repository
      uses: actions/checkout@v2
      with:
        repository: smallfawn/v_jstools
        ref: main
      env:
        TOKEN: ${{ secrets.action-workflows }}

    - name: Configure git
      run: |
        git config user.name github-actions
        git config user.email github-actions@github.com

    - name: Checkout upstream repository
      run: |
        git remote add upstream https://github.com/cilame/v_jstools.git
        git fetch upstream
        git checkout upstream/main -- .
      
    - name: Push changes to forked repository
      run: |
        git push origin main
